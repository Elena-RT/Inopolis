let
    Источник = Excel.Workbook(File.Contents("\\mt.rt.ru\fs\ECC\MAQ\B2O Аналитика КАМ\B2O_Заказы CMS\Аналитика включений\CMS_организация.xlsx"), null, true),
    #"Строки с примененным фильтром1" = Table.SelectRows(Источник, each ([Name] = "cms" or [Name] = "ИНН" or [Name] = "организация" or [Name] = "проработка")),
    cms1 = #"Строки с примененным фильтром1"{[Name="cms"]}[Data],
    #"Замененное значение5" = Table.ReplaceValue(cms1,"-",null,Replacer.ReplaceValue,{"Column76", "Column77", "Column78"}),
    #"Повышенные заголовки" = Table.PromoteHeaders(#"Замененное значение5", [PromoteAllScalars=true]),
    #"Замененное значение4" = Table.ReplaceValue(#"Повышенные заголовки","а","",Replacer.ReplaceValue,{"[Заказы]. Фактическая дата завершения проработки"}),
    #"Замененное значение" = Table.ReplaceValue(#"Замененное значение4","-",null,Replacer.ReplaceValue,{"[Заказы]. Дата начала предоставления услуги","[Заказы]. Контрольная дата организации", "[Заказы]. Дата регистрации", "[Заказы]. Дата окончания предоставления услуги", "[Заказы]. Дата перевода в статус", "[Заказы]. Фактическая дата завершения организации в заказе", "[Заказы]. Фактическая дата завершения проработки"}),
    #"Замененное значение1" = Table.ReplaceValue(#"Замененное значение","-",null,Replacer.ReplaceValue,{"[Заказы]. Ежемесячный платеж по тарифу со скидкой (AVG)", "[Заказы]. Ежемесячный платеж (AVG)", "[Заказы]. Плата за подключение (AVG)"}),
    #"Измененный тип" = Table.TransformColumnTypes(#"Замененное значение1",{{"[Заказы]. Адрес предоставления услуги", type text}, {"[Заказы]. Адрес предоставления услуги (регион)", type text}, {"[Заказы]. Адрес размещения оборудования", type text}, {"[Заказы]. Бизнес филиал", type text}, {"[Заказы]. Вид клиента", type text}, {"[Заказы]. Дата начала предоставления услуги", type date}, {"[Заказы]. Дата регистрации", type date}, {"[Заказы]. Дата перевода в статус", type date}, {"[Заказы]. Дата окончания предоставления услуги", type date}, {"[Заказы]. Фактическая дата завершения организации в заказе", type date}, {"[Заказы]. Фактическая дата завершения проработки", type date}}),
    #"Удаленные столбцы" = Table.RemoveColumns(#"Измененный тип",{"[Заказы]. Единый счет", "[Заказы]. fldismigration2"}),
    #"Условный столбец добавлен" = Table.AddColumn(#"Удаленные столбцы", "Статус_Архив_без архива", each if [#"[Заказы]. Статус"] = "Архив" then "Архив" else "Без архива"),
    #"Измененный тип1" = Table.TransformColumnTypes(#"Условный столбец добавлен",{{"[Заказы]. Емкость/скорость канала (ед изм)", type text}, {"[Заказы]. Емкость/скорость канала (знач)", type text}, {"[Заказы]. Клиент", type text}, {"[Заказы]. Код ЦФО", type text}, {"[Заказы]. Менеджер продаж КАМ", type text}, {"[Заказы]. Номер договора", type text}, {"[Заказы]. Номер заказа", type text}, {"[Заказы]. Номер статьи дохода", type text}, {"[Заказы]. Статус", type text}, {"[Заказы]. Субъект РФ", type text}, {"[Заказы]. Тип заказа", type text}, {"[Заказы]. Цифровая экономика", type text}, {"[Заказы]. Категория заказа", type text}, {"[Заказы]. Региона размещения оборудования оператора»", type text}, {"[Заказы]. Тип услуги", type text}, {"[Заказы]. Филиал заказа", type text}, {"[Заказы]. Менеджер продаж", type text}, {"[Клиенты]. ИНН", type text}, {"[Заказы]. Ежемесячный платеж по тарифу со скидкой (AVG)", type number}, {"[Заказы]. Ежемесячный платеж (AVG)", type number}, {"ИТОГО сумма", type number}, {"МГР", type text}, {"[Сервисы]. Дополнительные затраты", type text}, {"Статус", type text}, {"резерв", type number}, {"Ст.укрупненно", type text}, {"Ст.Детально", type text}, {"Отдел Продаж", type text}, {"неделя регистрации", type number}, {"месяц регистрации", type text}, {"год регистрации", type text}, {"территория", type text}, {"МРФ", type text}, {"Сцепка1", type text}, {"КАМ", type text}, {"РФ", type text}, {"КАМ_СПР4", type text}, {"КАМ_BI", type text}, {"КАМ_сверка", type text}, {"ИНН_BI", type text}, {"ИНН_ВГО", type text}, {"обращение", type text}, {"дельта", type number}, {"дельта_год", type number}, {"дельта_знак", type text}, {"интервал_знач", type text}, {"ЦЭ", type text}, {"[Заказы]. Связаный заказ (номер)", type text}, {"выполнение", type text}, {"Интервал", type number}, {"[Заказы]. Контрольная дата организации", type date}, {"Статус_Архив_без архива", type text}}),
    #"Дублированный столбец" = Table.DuplicateColumn(#"Измененный тип1", "[Заказы]. Контрольная дата организации", "Копия [Заказы]. Контрольная дата организации"),
    #"Переименованные столбцы" = Table.RenameColumns(#"Дублированный столбец",{{"Копия [Заказы]. Контрольная дата организации", "Копия [Заказы]. Контрольная дата орг_нач.мес"}}),
    #"Вычисленное начало месяца" = Table.TransformColumns(
    #"Переименованные столбцы",
    {
        {"Копия [Заказы]. Контрольная дата орг_нач.мес", each Date.ToText(_, "MMM yyyy"), type text}
    }
),